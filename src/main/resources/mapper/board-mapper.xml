<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Board">
    <select id="findAll" resultType="board">
        SELECT
            b.board_idx AS board_idx,    -- 게시판 인덱스
            b.title,               -- 제목
            b.content,             -- 내용
            b.good,                -- 좋아요 수
            b.created,             -- 생성일
            b.delete_yn,           -- 삭제 여부
            u.user_id,             -- 작성자 아이디
            u.user_idx AS user_idx,     -- 작성자 인덱스
            u.user_name            -- 작성자 이름
        FROM
            tb_board b
                LEFT JOIN
            tb_user u
            ON
                b.create_by = u.user_idx
        WHERE
            b.delete_yn = 'N'
    </select>

    <select id="detailBoard" parameterType="Integer" resultType="board">
        SELECT
            b.board_idx,
            b.title,
            b.content,
            b.good,
            DATE_FORMAT(b.created, '%Y-%m-%d %H:%i:%s') AS created, -- 날짜를 문자열로 포맷
            b.delete_yn,
            u.user_id AS userId,       -- 작성자 ID
            u.user_name AS userName,   -- 작성자 이름
            b.create_by AS userIdx    -- 작성자 인덱스 (BIGINT 타입)
        FROM
            tb_board b
                LEFT JOIN
            tb_user u
            ON
                b.create_by = u.user_idx
        WHERE
            b.board_idx = #{board_idx}
    </select>

    <insert id="writeBoard" parameterType="board">
        INSERT INTO tb_board (
            title,
            content,
            create_by,
            created,
            delete_yn
        )
        VALUES (
                   #{title},
                   #{content},
                   #{createByIdx}, -- 작성자 인덱스를 매핑
                   NOW(), -- 현재 날짜와 시간
                   'N' -- 기본값으로 'N' 설정
               )
    </insert>



</mapper>